<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>БУРАН-4 // MONITORING TERMINAL</title>
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background-color: #000;
      color: #0f0;
      font-family: 'Share Tech Mono', monospace;
      overflow: hidden;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .monitor {
      width: 90vw;
      max-width: 800px;
      height: 85vh;
      background-color: #0a0a0a;
      border: 8px solid #111;
      box-shadow: 0 0 30px rgba(0, 80, 0, 0.6), inset 0 0 15px rgba(0, 40, 0, 0.8);
      position: relative;
      overflow: hidden;
      padding: 20px;
      border-radius: 4px;
    }

    /* Эффект мерцания CRT */
    .monitor::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(rgba(0, 30, 0, 0.05), transparent 95%);
      pointer-events: none;
      animation: scanline 8s linear infinite;
    }

    @keyframes scanline {
      0% { background-position: 0 0; }
      100% { background-position: 0 100vh; }
    }

    .header {
      text-align: center;
      margin-bottom: 20px;
      font-family: 'Orbitron', sans-serif;
      font-size: 1.4rem;
      text-shadow: 0 0 8px #0f0, 0 0 16px #0a0;
      letter-spacing: 2px;
    }

    .terminal {
      line-height: 1.6;
      font-size: 1.1rem;
      white-space: pre-wrap;
      height: calc(100% - 80px);
      overflow-y: auto;
      padding: 10px;
      color: #0f0;
      text-shadow: 0 0 3px #0a0;
    }

    .blink {
      animation: blink 1s step-end infinite;
    }

    @keyframes blink {
      50% { opacity: 0; }
    }

    .input-line {
      margin-top: 15px;
      display: flex;
      align-items: center;
    }

    .prompt::after {
      content: '>';
      margin-right: 8px;
    }

    input {
      flex: 1;
      background: transparent;
      border: none;
      color: #0f0;
      font-family: 'Share Tech Mono', monospace;
      font-size: 1.1rem;
      outline: none;
      text-shadow: 0 0 3px #0a0;
    }

    input::placeholder {
      color: #080;
    }

    .timestamp {
      color: #8f8;
      font-size: 0.85rem;
      opacity: 0.8;
    }

    /* Комикс-панель — имитация всплывающего окна */
    .comic-panel {
      position: absolute;
      top: 20px;
      right: 20px;
      width: 220px;
      height: 280px;
      background: #050;
      border: 2px solid #0f0;
      box-shadow: 0 0 6px #0a0;
      padding: 10px;
      font-size: 0.85rem;
      display: none;
      z-index: 10;
    }

    .comic-panel.active {
      display: block;
      animation: popIn 0.4s ease-out;
    }

    @keyframes popIn {
      0% { transform: scale(0.8); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }

    .comic-header {
      text-align: center;
      font-weight: bold;
      margin-bottom: 8px;
      border-bottom: 1px dashed #0a0;
      padding-bottom: 4px;
    }

    .comic-img {
      width: 100%;
      height: 140px;
      background: #000 url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="220" height="140" viewBox="0 0 220 140"><rect width="220" height="140" fill="%230a0a0a"/><circle cx="110" cy="70" r="40" fill="none" stroke="%230f0" stroke-width="2"/><text x="110" y="75" text-anchor="middle" fill="%230f0" font-size="12" font-family="monospace">[REDACTED FACE]</text></svg>') center/cover no-repeat;
      margin-bottom: 8px;
    }

    .comic-text {
      font-size: 0.8rem;
      line-height: 1.5;
    }

    /* Звук реактора — индикатор */
    .reactor-indicator {
      position: absolute;
      bottom: 10px;
      left: 10px;
      font-size: 0.9rem;
      color: #8f8;
    }

    .reactor-glow {
      display: inline-block;
      width: 12px;
      height: 12px;
      background: #f00;
      border-radius: 50%;
      margin-right: 6px;
      box-shadow: 0 0 6px #f00;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 0.4; }
      50% { opacity: 1; }
    }

    /* Адаптив: на мобильных — убрать комикс-панель, сделать её "всплывающей по клику" */
    @media (max-width: 600px) {
      .comic-panel {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 90vw;
        height: auto;
        max-height: 80vh;
        overflow-y: auto;
      }
    }
  </style>
</head>
<body>

  <div class="monitor">
    <div class="header">
      [ SYSTEM: BURAN-4 RECON // USSR COLLAPSE ERA — 1991.12.21 ]  
    </div>

    <div class="terminal" id="terminal"></div>

    <div class="input-line">
      <span class="prompt"></span>
      <input type="text" id="command-input" placeholder="_" autocomplete="off" autofocus>
    </div>

    <div class="reactor-indicator">
      <span class="reactor-glow"></span><span>REACTOR CORE // STANDBY (δ = 0.87)</span>
    </div>

    <div class="comic-panel" id="comic-panel">
      <div class="comic-header">> INCOMING TRANSMISSION</div>
      <div class="comic-img" id="comic-img"></div>
      <div class="comic-text" id="comic-text"></div>
    </div>
  </div>

  <audio id="reactor-sound" loop preload="auto">
    <source src="https://www.soundjay.com/misc/sounds/geiger-counter-1.mp3" type="audio/mpeg">
    <!-- Лучше заменить на низкочастотный гул реактора: https://freesound.org/people/InspectorJ/sounds/416372/ -->
    <!-- Для демо — используем гейгер, как имитацию радиационного фона -->
  </audio>

  <script>
    // === CONFIG ===
    const reactorSound = document.getElementById('reactor-sound');
    const terminal = document.getElementById('terminal');
    const input = document.getElementById('command-input');
    const comicPanel = document.getElementById('comic-panel');
    const comicText = document.getElementById('comic-text');

    let phase = localStorage.getItem('buran4_phase') || 'intro';
    let messages = [];
    let currentMessageIndex = 0;

    // Запуск звука после первого взаимодействия (из-за политики браузеров)
    document.body.addEventListener('click', () => {
      if (reactorSound.paused) {
        reactorSound.volume = 0.2;
        reactorSound.play().catch(e => console.warn("Audio play failed:", e));
      }
    }, { once: true });

    // === UTILS ===
    function typeText(text, delay = 30, callback = null) {
      const lines = text.split('\n');
      let i = 0;
      const interval = setInterval(() => {
        if (i < lines.length) {
          terminal.innerHTML += `<div>${lines[i]}</div>`;
          terminal.scrollTop = terminal.scrollHeight;
          i++;
        } else {
          clearInterval(interval);
          if (callback) callback();
        }
      }, delay * 10);
    }

    function timestamp() {
      const now = new Date();
      return `[${now.getHours().toString().padStart(2,'0')}:${now.getMinutes().toString().padStart(2,'0')}:${now.getSeconds().toString().padStart(2,'0')}]`;
    }

    function log(msg, cls = '') {
      terminal.innerHTML += `<div class="${cls}"><span class="timestamp">${timestamp()}</span> ${msg}</div>`;
      terminal.scrollTop = terminal.scrollHeight;
    }

    function showComic(name, text) {
      comicText.textContent = text;
      comicPanel.classList.add('active');
      setTimeout(() => comicPanel.classList.remove('active'), 6000);
    }

    // === SCENES ===
    const scenes = {
      intro: () => {
        typeText(`
> SYSTEM INIT...
> LOADING 'ELECTRON' PROFILE...
> WELCOME, DANYA.
> CONNECTION ESTABLISHED — ENCRYPTED CHANNEL (AES-256 / ONETIME PAD)

> CONTEXT:
  - DATE: 21 DEC 1991
  - LOCATION: MOSCOW, USSR (STATUS: COLLAPSING)
  - OPERATION: BURAN-4 RECON
  - TARGET: SECRET FACILITY (COORDINATES PURCHASED VIA DARKNET)

  [RECENT TRANSACTIONS]
  > 18 DEC 1991: PAYMENT SENT (3 BTC — via anonymized mixer)
  > 19 DEC 1991: RECEIVED PHYSICAL FLASH DRIVE (USB 1.0, ENCRYPTED)
  > 20 DEC 1991: FLASH DRIVE INSERTED. HASH VERIFIED: 7a3f...e9c1

  [FLASH CONTENTS:]
    - MAP_FRAGMENT_01.BIN
    - AUDIO_LOG_BURAN4_07.WAV
    - DECRYPT_KEY_XOR.PAD
    - _NOTE_FROM_PHANTOM.TXT

> AWAITING INPUT...
        `.trim(), 25, () => {
          phase = 'note';
          localStorage.setItem('buran4_phase', phase);
          input.focus();
        });
      },

      note: () => {
        log("> EXECUTING: cat _NOTE_FROM_PHANTOM.TXT");
        setTimeout(() => {
          typeText(`
--- BEGIN NOTE ---
Danya,

We found it. Buran-4 isn’t a shuttle. It’s a *reactor core* — self-sustaining, thorium-based, 
prototype code-named "Zarya-9". Buried under Site-12 near Baikonur.

Soviets shut it down in '89… but telemetry from KH-11 showed *heat signatures* as of last week.

They lied. It’s still alive.

The coordinates you bought? They’re real. But be careful — 
the Americans didn’t "leak" them. They *planted* them. 
This is bait. You’re walking into a trap… or a tomb.

— Phantom (ex-NSA, now ghost)
--- END NOTE ---

> SYSTEM WARNING: AUDIO_LOG_BURAN4_07.WAV CONTAINS HIGH-INTENSITY ACUSTIC ANOMALY (Δf = 17.3 Hz)
> PLAYBACK MAY INDUCE NAUSEA / VISUAL DISTORTION.

> OPTIONS:
  [1] PLAY AUDIO_LOG_BURAN4_07.WAV
  [2] DECRYPT MAP_FRAGMENT_01.BIN
  [3] ANALYZE DECRYPT_KEY_XOR.PAD
  [4] IGNORE — PREPARE FOR INSERTION (COORDINATES: 45.6307° N, 63.3322° E)
          `.trim(), 30, () => {
            input.focus();
          });
        }, 800);
      }
    };

    // === INPUT HANDLER ===
    input.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        const cmd = input.value.trim().toLowerCase();
        log(`> ${cmd}`);
        input.value = '';

        if (phase === 'intro') {
          log("ERR: SYSTEM NOT READY. WAIT FOR INIT...");
          return;
        }

        if (phase === 'note') {
          switch (cmd) {
            case '1':
            case 'play audio':
              log("> EXECUTING: play AUDIO_LOG_BURAN4_07.WAV");
              setTimeout(() => {
                log("[AUD] ▶ PLAYBACK STARTED...", 'blink');
                // Здесь можно добавить воспроизведение реального звука (низкочастотный гул + искажения)
                showComic("Phantom", "Don't listen too long. Last guy who did — started seeing *wires in his skin*.");
              }, 500);
              break;

            case '2':
            case 'decrypt map':
              log("> DECRYPTING MAP_FRAGMENT_01.BIN...");
              setTimeout(() => {
                log("[OK] MAP DECRYPTED. DISPLAYING COORDINATE OVERLAY.");
                log("      [██████████████████] 100%");
                log("      TARGET: BAikonur Perimeter — Sector Ψ (Psi)");
                log("      WARNING: RAD LEVELS ↑ 4.7 mSv/h (NORMAL: 0.03)");
                showComic("Danya", "This isn’t a base. It’s a *sarcophagus*… and something’s breathing inside.");
                // → переход к следующей фазе (например, карта)
              }, 1200);
              break;

            case '4':
            case 'prepare':
              log("> INITIATING INSERTION PROTOCOL...");
              setTimeout(() => {
                log("[SYS] PACKING: Geiger counter, NVG (Gen 1), EMP flashbang, cipher wheel.");
                log("[GPS] LOCKED ON: 45.6307°N, 63.3322°E");
                log("[MSG] Phantom just sent: \"If the lights go out — don’t turn them back on.\"");
                log("\n> PRESS [ENTER] TO BEGIN INSERTION...");
                // → переход к экрану выезда на местность (следующая страница или сцена)
              }, 1000);
              break;

            default:
              log(`ERR: UNKNOWN COMMAND '${cmd}'. TRY: 1, 2, 3, or 4`);
          }
        }
      }
    });

    // === START ===
    window.addEventListener('load', () => {
      log("> BOOTING CRT MONITOR v2.1 (RETRO-91 KERNEL)");
      setTimeout(() => {
        scenes.intro();
      }, 800);
    });
  </script>
</body>
</html>
